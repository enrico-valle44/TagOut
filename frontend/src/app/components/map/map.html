<div id="map">
</div>

<button class="add-button" mat-fab color="primary" [routerLink]="['/add']">
  <mat-icon>add</mat-icon>
</button>

<ng-template #popupTemplate let-properties="properties" let-colors="colors">
  <div class="custom-popup" 
       [style.background]="colors.bg"
       [style.border-color]="colors.text">
    
    <div class="popup-image-section">
      <img [src]="properties.images?.[0] || 'https://via.placeholder.com/280x140/4A90E2/FFFFFF?text=Graffiti+Image'" 
           [alt]="properties.title"
           class="popup-image">
    </div>

    <div class="popup-content-section">
      <h3 class="popup-title">{{ properties.title }}</h3>

      <p class="popup-description" *ngIf="properties.description">
        {{ properties.description.length > 100 ? (properties.description | slice:0:100) + '...' : properties.description }}
      </p>

      <div class="popup-categories" *ngIf="properties.categories && properties.categories.length > 0">
        <span *ngFor="let category of properties.categories | slice:0:3" 
              class="category-chip"
              [style.background]="colors.text + '22'"
              [style.color]="colors.text"
              [style.border-color]="colors.text + '44'">
          {{ category }}
        </span>
      </div>

      <div class="popup-date" *ngIf="properties.date">
         {{ properties.date | date:'dd/MM/yyyy' }}
      </div>

      <div class="popup-hint">
         Clicca per scoprire di più su "{{ properties.title }}" →
      </div>
    </div>
  </div>
</ng-template>